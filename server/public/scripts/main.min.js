function mainPageLogic(){function a(a){if($(".playlistoptionview").empty(),0==a.songs.length)$(".playlistoptionview").text("You currently have no songs in your playlist.");else{userPlaylist=a.songs,$(".playlistoptionview").append('<ul class="playlistviewlist"></ul>');for(var b=0,c=userPlaylist.length-1;c>-1;c--)$(".playlistviewlist").append('<li class="playlistviewlistitem innersearchdiv"><div class="movesongtofirst option" id="movesongtofirst'+b+'">&#8593;</div><div class="removesongbtn orlogregbtn" id="removesongbtn'+b+'">-</div><img src="'+userPlaylist[c].imgUrl+'" class="playlistimg"/><br><span class="songnameplaylistitem">'+userPlaylist[c].songName+"</span></li>"),$("#removesongbtn"+b).data("songId",userPlaylist[c].songId),$("#movesongtofirst"+b).data("song",userPlaylist[c]),b++;$(".movesongtofirst").hide()}}socket=io(),$.getScript("/scripts/youtube.min.js"),socket.on("current dj",function(a){$(".queuebox").text(a)}),socket.on("user disconnect",function(){socket.emit("ids from client",userInfo.username)});var b=0;socket.on("update current song css",function(a){console.log(a),a==userInfo.username&&(0==b?($(".playlistviewlist").children().eq(b).css("background-color","#56C247"),b++):($(".playlistviewlist").children().css("background-color","#34509D"),$(".playlistviewlist").children().eq(b).css("background-color","#56C247"),b++))}),socket.on("user playlist finished",function(a){console.log(a,"hit"),a==userInfo.username&&(b=0,$(".leavedjqueue").hide(),$(".joindjqueue").show(),$(".playlistviewlist").children().css("background-color","#34509D"))}),socket.on("user wants userlist",function(a){console.log("hit"),$(".userlistoptionview").empty();for(var b=0;b<a.length;b++)$(".userlistoptionview").append('<li class="userlistitem innersearchdiv">'+a[b]+"</li>")}),socket.on("switch users",function(){clearCurrentTime(),playNextSong()}),$(".playlistoptionview").show(),$.ajax({method:"GET",url:"/userinformation"}).done(function(b){userInfo=b;var c={userId:userInfo.username};$.ajax({method:"POST",url:"/getuserplaylist",data:c}).done(function(b){0!=b.length&&(a(b),socket.emit("user wants userlist",userInfo.username))})}),$(".logOutBtn").on("click",function(){$.ajax({method:"GET",url:"/logout"}).done(function(a){"logged out"==a&&location.reload()})}),$(".leftcontaineroptionbtn").on("click",function(){$(".playlistcontainerbtn").addClass("orlogregbtn"),$(".addsongcontainerbtn").addClass("orlogregbtn"),$(".userscontainerbtn").addClass("orlogregbtn"),$(".chatboxcontainerbtn").addClass("orlogregbtn"),$(this).removeClass("orlogregbtn"),"Add Song"==$(this).prev().text()?($(".optionviewleft").hide(),$(".userlistoptionview").show(),socket.emit("user list update")):"Playlist"==$(this).prev().text()?($(".optionviewleft").hide(),$(".addsongoptionview").show(),$(".addsongsearch").focus()):"Users List"==$(this).prev().text()?($(".optionviewleft").hide(),$(".chatboxoptionview").show(),$(".chatboxcontainerbtn").text("Chat")):($(".optionviewleft").hide(),$(".playlistoptionview").show())}),$("body").on("click",".removesongbtn",function(){console.log($(this).parent().index());var b={userId:userInfo.username,songId:$(this).data("songId")};$.ajax({method:"POST",url:"/removesong",data:b}).done(function(b){a(b)})}),$("body").on("click",".movesongtofirst",function(){var b={userId:userInfo.username,songs:$(this).data("song")};$.ajax({method:"POST",url:"/movesongtotop",data:b}).done(function(b){console.log(b),a(b)})}),$("body").on("mouseenter",".playlistviewlistitem",function(){0!=$(this).index()&&($(this).children(":first-child").show(),$(this).children(":nth-child(3)").css({"margin-left":"1px"}))}),$("body").on("mouseleave",".playlistviewlistitem",function(){$(".movesongtofirst").hide(),$(".playlistimg").css({"margin-left":"55px"})});var c=[],d=[];$(".addsongsearch").on("keyup",function(a){if(a.preventDefault(),13==a.which){c=[],d=[],$(".searchvideosholder").empty();var b=gapi.client.youtube.search.list({part:"snippet",type:"video",q:encodeURIComponent($(".addsongsearch").val()).replace(/%20/g,"+"),maxResults:10,order:"viewCount"});b.execute(function(a){for(i=0;i<a.items.length;i++)c.push(a.items[i].id.videoId),d.push(a.items[i].snippet.thumbnails["default"].url),$(".searchvideosholder").append('<div class="searchedvideodiv"><div class="addsong2pl btn">+</div><div class="innersearchdiv"><img src="'+a.items[i].snippet.thumbnails["default"].url+'" class="centersearchimg"/><div class="clearfix"></div><span class="searchedvideotitle">'+a.items[i].snippet.title+"</span></div></div>")}),$(".addsongsearch").val("")}}),$("body").on("click",".addsong2pl",function(b){b.preventDefault();var e=$(this).parent().children(),f=$(this).parent().find(".searchedvideotitle"),g=$(this).parent().find(".centersearchimg"),h=$(this).parent().find(".addsong2pl"),i=$(this).parent().text().substring(1),j={userId:userInfo.username,songs:{songName:i,songId:c[$(this).parent().index()],imgUrl:d[$(this).parent().index()]}};$.ajax({method:"POST",url:"/addsongtoplaylist",data:j}).done(function(b){e.css("background","#56C247"),g.css("margin","0px"),f.text("Added to playlist!"),h.hide(),a(b)})}),$("body").on("click",".joindjqueue",function(){$(".joindjqueue").hide(),$(".leavedjqueue").show(),socket.emit("user wants to join dj list",userInfo.username)}),$("body").on("click",".leavedjqueue",function(){$(this).hide(),$(".joindjqueue").show(),socket.emit("leave dj list",userInfo.username),$(".playlistviewlist").children().css("background-color","#34509D"),b=0}),$(".messageinput").on("keyup",function(a){if(a.preventDefault(),13==a.which){var b={userId:userInfo.username,msg:$(this).val()};socket.emit("user chat message",b),$(this).val("")}}),socket.on("user chat message",function(a){$(".messagesholder").append('<li><span class="usernamemsg">'+a.userId+"</span>: "+a.msg+"</li>"),$(".chatbody").scrollTop($(".messagesholder").height()),"none"!=$(".chatboxcontainerbtn").css("display")&&"none"==$(".chatboxoptionview").css("display")&&$(".chatboxcontainerbtn").text("Chat *")});var e=0;$(".helpBtn").on("click",function(){$(".helppagebg").show(),$(".helpclasscontent").show(),$(".steptwo").hide(),$(".stepthree").hide(),$(".stepfour").hide(),$(".backbtn").hide()}),$(".forwardbtn").on("click",function(){e++,1==e&&($(".stepone").hide(),$(".steptwo").show(),$(".backbtn").show()),2==e&&($(".stepone").hide(),$(".steptwo").hide(),$(".stepfour").hide(),$(".stepthree").show()),3==e&&($(".stepthree").hide(),$(".stepfour").show()),e>3&&($(".stepfour").hide(),$(".backbtn").hide(),$(".stepone").show(),e=0)}),$(".backbtn").on("click",function(){e--,0==e&&($(".stepone").show(),$(".backbtn").hide(),$(".steptwo").hide()),1==e&&($(".steptwo").show(),$(".stepone").hide(),$(".stepthree").hide()),2==e&&($(".stepthree").show(),$(".stepfour").hide())}),$("body").on("click",".helppagebg",function(){$(this).hide(),$(".helpclasscontent").hide()})}var userInfo,userPlaylist,socket,mainPageCounter=0;